// パフォーマンスチューニング (高速化の肝)
// ---------------------------------------------------
// ペインの枠線を描画しない。描画負荷が減り、コピー時の邪魔にもなりません。
pane_frames false
// マウス操作を有効化 (tmuxの `setw -g mouse on` 相当)
mouse_mode true
// クリップボード連携 (macOS用)
copy_command "pbcopy"
copy_clipboard "system"
// スクロールバッファ (tmuxの 100000行 に合わせる)
scroll_buffer_size 100000
// テーマ (TokyoNightに近いもの、あるいはデフォルト)
theme "tokyo-night"
// デフォルトのモード設定
// "locked" をデフォルトにすることで、通常時はキー入力をそのままシェルに渡します
default_mode "locked"
// キーバインディング設定
keybinds {
    // 全モード共通: 解除キーなど
    shared_except "locked" {
        bind "Esc" {
            SwitchToMode "Locked"
        }
        bind "Enter" {
            SwitchToMode "Locked"
        }
        bind "Ctrl c" {
            SwitchToMode "Locked"
        }
    }
    // 通常モード (Locked)
    // tmuxの Prefix (C-t) を押すと "tmux" モード (操作モード) に移行します
    locked {
        bind "Ctrl t" {
            SwitchToMode "Tmux"
        }
    }
    // Tmuxモード (Prefixを押した後の状態)
    // ここで .tmux.conf のキーバインドを再現します
    tmux {
        // --- ペイン操作 ---
        // bind | split-window -h
        bind "|" {
            NewPane "Right"
            SwitchToMode "Locked"
        }
        // bind - split-window
        bind "-" {
            NewPane "Down"
            SwitchToMode "Locked"
        }
        // bind h select-pane -t :.- (前のペイン)
        bind "h" {
            MoveFocus "Left"
        }
        // Zellijは方向指定が基本ですがLeft/Rightで代用        // bind l select-pane -t :.+ (次のペイン)
        bind "l" {
            MoveFocus "Right"
        }
        bind "j" {
            MoveFocus "Down"
        }
        bind "k" {
            MoveFocus "Up"
        }
        // bind k confirm-before "kill-window" (ここではペイン削除に割り当て)
        bind "k" {
            CloseFocus
            SwitchToMode "Locked"
        }
        // --- ウィンドウ(タブ)操作 ---
        // bind c new-window
        bind "c" {
            NewTab
            SwitchToMode "Locked"
        }
        // ウィンドウ移動 (p: previous, n: next)
        bind "p" {
            GoToPreviousTab
        }
        bind "n" {
            GoToNextTab
        }
        // --- コピーモードへ ---
        // bind [ copy-mode
        bind "[" {
            SwitchToMode "Scroll"
        }
        // --- その他 ---
        // bind w: セッションマネージャーをフローティングで開く
        bind "w" {
            LaunchOrFocusPlugin "session-manager" {
                floating true
                move_to_focused_tab true
            }
            SwitchToMode "Locked"
        }
        // デタッチ
        bind "d" {
            Detach
        }
    }
    // スクロール/コピーモード (tmuxの copy-mode-vi 相当)
    scroll {
        bind "Esc" {
            SwitchToMode "Locked"
        }
        bind "j" {
            ScrollDown
        }
        bind "k" {
            ScrollUp
        }
        bind "Ctrl f" {
            PageScrollDown
        }
        bind "Ctrl b" {
            PageScrollUp
        }
        // v で選択開始 (Visual mode)
        bind "v" {
            EditScrollback
            SwitchToMode "Locked"
        }
        // Zellijはエディタで開くのが強力        // または簡易コピーなら
        bind "Space" {
            SwitchToMode "EnterSearch"
        }
    }
}
// UI設定
ui {
    pane_frames {
        hide_session_name true
    }
}

